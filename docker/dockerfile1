FROM python:3.6.3-alpine3.6
MAINTAINER rafpyprog "rafael.alves.ribeiro@gmail.com"
#FROM joyzoursky/python-chromedriver:3.6-xvfb

ENV app /captcha-audio
ENV DISPLAY=:99
ENV DBUS_SESSION_BUS_ADDRESS=/dev/null

# Install python package requirements
COPY requirements.txt .

RUN echo '@edge http://dl-4.alpinelinux.org/alpine/edge/community/' >> /etc/apk/repositories

# Instala chrome e chromedriver
RUN apk update
RUN apk --progress add chromium@edge
RUN apk --progress add chromium-chromedriver@edge
RUN apk --progress add xvfb
#RUN apk --no-cache add chromium@edge chromium-chromedriver@edge

RUN pip install pyvirtualdisplay selenium

COPY test_selenium.py .

#RUN apk add bash \
#            sox \
#            curl \
#            gcc \
#             libexif xvfb \
#            build-base python-dev python3-dev jpeg-dev zlib-dev freetype-dev \
#            lcms2-dev openjpeg-dev tiff-dev tk-dev tcl-dev harfbuzz-dev \
#            fribidi-dev \
#        && LIBRARY_PATH=/lib:/usr/lib pip install -r requirements.txt \
#        && rm requirements.txt
#
#
# Create app folder and copy source code

#RUN mkdir app
#WORKDIR $app

EXPOSE 8888

CMD ["python", "test_selenium.py"]
